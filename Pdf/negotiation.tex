\documentclass{article}
\usepackage[landscape,lmargin=1cm,rmargin=1cm,paperheight=40cm]{geometry}
\usepackage[T1]{fontenc}

\usepackage{MPST}

\newcommand{\tuple}[1]{\langle #1\rangle}

\title{Negotiation~\cite{DemangeonNested2012}}
\date{}
\begin{document}
	\maketitle

	\paragraph{Remark.}
	Originally, this protocol was presented to showcase nested protocols. Here,
	we inline the protocol to fallback on more standard MPST.

	In addition, here, to allow projection on $\participant{I}$, we add a
	message from $\participant{A}$ to $\participant{I}$, after
	$\lbl{Accept}$/$\lbl{Counter}$.

	Participants:
	\begin{itemize}
		\item $\participant{C}$: the client;
		\item $\participant{I}$: an instrument the client wants to use;
		\item $\participant{A}$: an agent that negotiate with the client the
		conditions of use of the instrument.
	\end{itemize}

	$$
	\gtComm{C}{A}{
		{{Request}{
				\gtComm{A}{I}{
					{{Connect}{
							\gtComm{I}{A}{
								{{Available}{
										\gtComm{A}{C}{
											{{Ack}{
	\gtComm{A}{C}{
		{{Ask}[Terms]{
				\gtRec{n}{
					\gtComm{C}{A}{
						{{Proposition}[Contract]{
								\gtComm{A}{C}{
									{{Accept}{
											\gtComm{A}{I}{
												{{Start}{
														\gtRec{t}{
															\gtComm{C}{I}{
																{{Abort}{\gtEnd}}
																{{Command}[Code]{
																		\gtComm{I}{C}{
																			{{Result}[Data]{\gtVar{t}}}
																		}
																}}
															}
														}
												}}
											}
									}}
									{{Counter}[Contract]{
											\gtComm{A}{I}{
												{{Wait}{
													\gtVar{n}
												}}
											}
									}}
								}
						}}
					}
				}
		}}
	}
											}}
										}
								}}
							}
					}}
				}
		}}
	}
	$$

	\bibliographystyle{plain}
	\bibliography{db}
\end{document}